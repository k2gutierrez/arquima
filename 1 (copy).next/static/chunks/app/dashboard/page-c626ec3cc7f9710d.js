(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4087:function(e,a,t){Promise.resolve().then(t.bind(t,4604))},4604:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return y}});var s=t(7437),l=t(2265),i=t(6691),n=t.n(i),o=t(1396),r=t.n(o),c=t(2781),d=t(4033),m=t(8686),u=t(1577),x=t(9942),h=t(4086),f=t(7829),p=t(2827),b=t(6648),N=t(8378);t(8431);var j=t(3710),v=t(8591),g=t(9054),F=t(8775),E=t(1435),S=t(9817);function y(){let[e,a]=(0,l.useState)(""),{user:t,currentRol:i,currentName:o}=(0,c.Eu)(),y=(0,d.useRouter)(),[C,D]=(0,l.useState)(!1),[I,O]=(0,l.useState)(""),[A,w]=(0,l.useState)(!1),[T,P]=(0,l.useState)(""),[k,L]=(0,l.useState)(""),[R,Z]=(0,l.useState)(""),[_,J]=(0,l.useState)(""),[V,q]=(0,l.useState)(""),[U,M]=(0,l.useState)(void 0),[B,X]=(0,l.useState)(""),[z,Q]=(0,l.useState)(""),[G,H]=(0,l.useState)(""),[K,W]=(0,l.useState)([""]),[Y,$]=(0,l.useState)(null),[ee,ea]=(0,l.useState)(""),[et,es]=(0,l.useState)(""),[el,ei]=(0,l.useState)("SOLTERO"),[en,eo]=(0,l.useState)("NA"),[er,ec]=(0,l.useState)(null),[ed,em]=(0,l.useState)(null),[eu,ex]=(0,l.useState)([{id:"none",nombre:"none"}]),[eh,ef]=(0,l.useState)(null);async function ep(){if(""!=B){let e=(0,h.JU)(p.db,"propiedades",B),a=await (0,h.QT)(e);a.exists()&&q(a.data().folio)}}async function eb(){if(""!=z){let e=(0,h.JU)(p.db,"empleados",z),a=await (0,h.QT)(e);a.exists()&&M(a.data().nombre)}}async function eN(){let e=(0,h.IO)((0,h.hJ)(p.db,"empleados")),a=await (0,h.PL)(e),t=[];a.forEach(e=>{t.push(e.data())}),$(t);let s=[];await a.forEach(e=>{let a=e.data();"vendedor"==a.rol&&s.push(e.data())}),ex(s)}async function ej(){let e=(0,h.IO)((0,h.hJ)(p.db,"clientes")),a=await (0,h.PL)(e),t=[];a.forEach(e=>{t.push(e.data())}),ef(t)}async function ev(){let e=(0,h.IO)((0,h.hJ)(p.db,"propiedades")),a=await (0,h.PL)(e),t=[];await a.forEach(e=>{t.push(e.data())}),ec(t);let s=[];await a.forEach(e=>{let a=e.data();"LIBRE"==a.status&&s.push(e.data())}),em(s)}async function eg(){try{let e={nombre:T,email:k,cel:R,pago:(0,F._)(_),status:"ARMADO DE EXPEDIENTE",esquema:G,[ee]:et,civil:el,regimen_patrimonial:en,folio:V,propiedadID:B,asesor:U,asesorID:z,terminos:!1,historial:[{registrado:o,fecha:h.EK.fromDate(new Date),comentario:"Registrado como cliente"}]},t=(0,h.hJ)(p.db,"clientes"),s=new h.JU(t),l=s.id,i={id:l,...e};await (0,h.pl)(s,i);let n=(0,h.JU)(p.db,"propiedades",B);await (0,h.r7)(n,{status:"ARMADO DE EXPEDIENTE",status_interno:"ARMADO DE EXPEDIENTE",asesor:U,nombre:T,esquema:G}),O("Registro exitoso"),eC(),w(!A),a("inicio")}catch(e){O(e),eC()}}(0,l.useEffect)(()=>{null==t?y.push("/"):"owner"!=i?y.push("/user-validation"):"owner"==i&&(eN(),ev(),ej())},[t,A]),(0,l.useEffect)(()=>{ep()},[B]),(0,l.useEffect)(()=>{eb()},[z]),(0,l.useEffect)(()=>{if(null!=er){let e=[];er.forEach(a=>{if(e.map(e=>e.proyecto).includes(a.proyecto))for(let t=0;t<e.length;t++){e[t].proyecto===a.proyecto&&e[t].data.push(a.proyecto);break}else e.push(a.proyecto)}),W(new Set(e))}},[er,e]),(0,l.useEffect)(()=>{switch(G){case"CONTADO":case"FOVISSSTE-infonavit-fovissste":case"FOVISSSTE-tradicional":case"FOVISSSTE-conyugal":case"FOVISSSTE-para-todos":case"BANCARIO-terreno":case"BANCARIO-casa":ea("CURP");break;case"INFOVANIT-tradicional":case"INFOVANIT-unamos-creditos":case"INFOVANIT-conyugal":case"INFOVANIT-infonavit-fovissste":case"INFOVANIT-crediterreno":case"INFOVANIT-segundo-credito":case"INFOVANIT-cofinativ":ea("NSS");break;case"IPEJAL-tradicional":case"IPEJAL-terreno":case"IPEJAL-conyugal":ea("N_Afiliado")}},[G]);let eF=[{dataField:"folio",text:"Folio",sort:!0,editable:!1,filter:(0,j.DN)()},{dataField:"proyecto",text:"Proyecto",sort:!0,filter:(0,j.DN)()},{dataField:"inmueble",text:"Inmueble",sort:!0},{dataField:"direccion",text:"Direcci\xf3n",sort:!0},{dataField:"numero_ext.",text:"N\xfamero Ext.",sort:!0},{dataField:"lte",text:"lte",sort:!0},{dataField:"mz",text:"mz",sort:!0},{dataField:"nivel",text:"nivel",sort:!0},{dataField:"status",text:"Status",sort:!0},{dataField:"status_interno",text:"Status Interno",sort:!0},{dataField:"precio",text:"Precio",sort:!0},{dataField:"asesor",text:"Asesor",sort:!0},{dataField:"esquema",text:"Esquema",sort:!0},{dataField:"nombre",text:"Cliente",sort:!0},{dataField:"observaciones",text:"Obs.",sort:!0}],eE=[{dataField:"folio",text:"Folio",sort:!0,filter:(0,j.DN)()},{dataField:"nombre",text:"Nombre",sort:!0,editable:!1,filter:(0,j.DN)()},{dataField:"asesor",text:"Asesor",sort:!0,filter:(0,j.DN)()},{dataField:"esquema",text:"Esquema",sort:!0,filter:(0,j.DN)()},{dataField:"status",text:"Status",sort:!0,filter:(0,j.DN)()},{dataField:"cel",text:"Cel",sort:!0,filter:(0,j.DN)()},{dataField:"email",text:"Email",sort:!0,filter:(0,j.DN)()},{dataField:"propiedadID",text:"IDpropiedad",sort:!0,filter:(0,j.DN)()}],eS=[{dataField:"id",text:"ID",sort:!0,filter:(0,j.DN)()},{dataField:"nombre",text:"Nombre",sort:!0,filter:(0,j.DN)()},{dataField:"email",text:"Email",sort:!0,filter:(0,j.DN)()},{dataField:"rol",text:"Rol",sort:!0,filter:(0,j.DN)()}],ey=()=>D(!1),eC=()=>D(!0);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{onClick:ey,show:C,onHide:ey,message:I,button:"aceptar"}),(0,s.jsx)("nav",{className:"navbar bg-body-tertiary sticky-top",children:(0,s.jsxs)("div",{className:"container-fluid",children:[(0,s.jsxs)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvasNavbar","aria-controls":"offcanvasNavbar","aria-label":"Toggle navigation",children:[(0,s.jsx)(n(),{alt:"logo",src:u.Z,width:30,height:30}),(0,s.jsx)("span",{className:"navbar-toggler-icon"})]}),(0,s.jsx)("ul",{className:"navbar-nav ms-auto mb-2 mb-lg-0",children:(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)("a",{children:o})})}),(0,s.jsx)("button",{type:"button",className:"btn btn-secondary ms-3",onClick:m.Z,children:"Log Out"}),(0,s.jsxs)("div",{className:"offcanvas offcanvas-start",tabIndex:"-1",id:"offcanvasNavbar","aria-labelledby":"offcanvasNavbarLabel",children:[(0,s.jsxs)("div",{className:"offcanvas-header",children:[(0,s.jsx)(n(),{alt:"logo",src:x.Z,width:150,height:60}),(0,s.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]}),(0,s.jsx)("div",{className:"offcanvas-body",children:(0,s.jsxs)("ul",{className:"navbar-nav justify-content-end flex-grow-1 pe-3",children:[(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(r(),{href:"",children:(0,s.jsx)("button",{type:"button",onClick:()=>a(""),className:"btn","data-bs-dismiss":"offcanvas",children:"Inicio"})})}),(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(r(),{href:"",children:(0,s.jsx)("button",{type:"button",onClick:()=>a("empleados"),className:"btn","data-bs-dismiss":"offcanvas",children:"Empleados"})})}),(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(r(),{href:"",children:(0,s.jsx)("button",{type:"button",onClick:()=>a("registrarC"),className:"btn","data-bs-dismiss":"offcanvas",children:"Registrar Clientes"})})}),(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(r(),{href:"",children:(0,s.jsx)("button",{type:"button",onClick:()=>a("clientes"),className:"btn","data-bs-dismiss":"offcanvas",children:"Lista de clientes"})})}),(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(r(),{href:"",children:(0,s.jsx)("button",{type:"button",onClick:()=>a("propiedades"),className:"btn","data-bs-dismiss":"offcanvas",children:"Propiedades"})})}),(0,s.jsx)("li",{className:"nav-item"})]})})]})]})}),(0,s.jsxs)("div",{className:"container-fluid text-center",children:[""==e||"inicio"==e?(0,s.jsx)("div",{className:"row justify-content-center",children:(0,s.jsx)(g.Z,{})}):(0,s.jsx)(s.Fragment,{}),"empleados"==e?(0,s.jsx)("div",{className:"row justify-content-center",children:null!=er&&er.length>0?(0,s.jsx)(b.Z,{striped:!0,condensed:!0,hover:!0,keyField:"id",data:Y,columns:eS,pagination:(0,N.ZP)(),filter:(0,j.ZP)(),rowEvents:{onClick:(e,a,t)=>{y.push("/dashboard/empleado/".concat(a.id))}}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{className:"img-fluid",alt:"engrane",src:S.Z,width:350,height:210}),(0,s.jsx)("p",{children:"Loading..."})]})}):(0,s.jsx)(s.Fragment,{}),"registrarC"==e?(0,s.jsx)("div",{className:"row justify-content-center text-center",children:(0,s.jsxs)("div",{className:"col-md-6 col-12 mt-4",children:[(0,s.jsx)(n(),{className:"img-fluid",alt:"logo",src:x.Z,width:450,height:360}),(0,s.jsx)("h3",{className:"my-3",children:"Registro de Cliente"}),(0,s.jsxs)("form",{className:"form",children:[(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("label",{htmlFor:"nombre",className:"form-label",children:"Nombre completo"}),(0,s.jsx)("input",{type:"text",onChange:e=>P(e.target.value.toUpperCase()),value:T,name:"nombre",className:"form-control",id:"nombre",placeholder:"Nombre Completo"})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),(0,s.jsx)("input",{required:!0,type:"email",onChange:e=>L(e.target.value),value:k,name:"email",className:"form-control",id:"email",placeholder:"name@example.com"})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("label",{htmlFor:"cel",className:"form-label",children:"Celular - 10 digitos"}),(0,s.jsx)("input",{required:!0,type:"text",maxLength:10,onChange:e=>Z(e.target.value),value:R,name:"cel",className:"form-control",id:"cel",placeholder:"Celular: 3312345678"})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("label",{htmlFor:"pago",className:"form-label",children:"Pago inicial"}),(0,s.jsx)("input",{type:"text",onChange:e=>J(e.target.value),value:_,name:"pago",className:"form-control",id:"pago",placeholder:"5000"})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("p",{children:"Selecciona el Folio de la propiedad"}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>{X(e.target.value)},"aria-label":"Default select example",children:[(0,s.jsx)("option",{value:"",children:"Folio"}),ed.map(e=>(0,s.jsx)("option",{value:e.id,children:e.folio},e.id))]})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("p",{children:"Selecciona al Asesor encargado de este cliente: "}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>Q(e.target.value),"aria-label":"Default select example",children:[(0,s.jsx)("option",{value:"",children:"Asesor"}),eu.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("p",{children:"Elige el esquema: "}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>H(e.target.value),"aria-label":"Default select example",children:[(0,s.jsx)("option",{value:"",children:"Tipo de Tr\xe1mite"}),f.g.map((e,a)=>(0,s.jsx)("option",{value:e,children:e},a))]})]}),""!=G?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.Z,{tipo:ee,value:et,onChange:e=>es(e.target.value.toUpperCase())}),(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("p",{children:"Estado Civil"}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>ei(e.target.value),"aria-label":"Default select example",children:[(0,s.jsx)("option",{value:"",children:"Selecciona una opci\xf3n"}),(0,s.jsx)("option",{value:"SOLTERO",children:"SOLTERO"}),(0,s.jsx)("option",{value:"CASADO",children:"CASADO"})]})]})]}):(0,s.jsx)(s.Fragment,{}),"SOLTERO"!=el?(0,s.jsxs)("div",{className:"mb-3 mx-5",children:[(0,s.jsx)("p",{children:"R\xe9gimen Patrimonial"}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>eo(e.target.value),"aria-label":"Default select example",children:[(0,s.jsx)("option",{value:"",children:"Selecciona una opci\xf3n"}),(0,s.jsx)("option",{value:"SOCIEDAD LEGAL / MANCOMUNADO",children:"Sociedad legal / Mancomunado"}),(0,s.jsx)("option",{value:"BIENES SEPARADOS",children:"Bienes separados"})]})]}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("div",{className:"my-5",children:(0,s.jsx)("button",{type:"button",onClick:eg,className:"btn btn-secondary",children:"Registrar"})})]})]})}):(0,s.jsx)(s.Fragment,{}),"propiedades"==e?(0,s.jsx)("div",{className:"mt-5 mb-5",children:null!=er&&er.length>0?(0,s.jsx)(b.Z,{striped:!0,condensed:!0,hover:!0,keyField:"id",data:er,columns:eF,pagination:(0,N.ZP)(),filter:(0,j.ZP)(),rowEvents:{onClick:(e,a,t)=>{y.push("/dashboard/propiedad/".concat(a.id))}}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{className:"img-fluid",alt:"engrane",src:S.Z,width:350,height:210}),(0,s.jsx)("p",{children:"Loading..."})]})}):(0,s.jsx)(s.Fragment,{}),"clientes"==e?(0,s.jsx)("div",{className:"m-5 p-2",children:null!=eh&&eh.length>0?(0,s.jsx)(b.Z,{striped:!0,condensed:!0,hover:!0,keyField:"id",data:eh,columns:eE,pagination:(0,N.ZP)(),filter:(0,j.ZP)(),rowEvents:{onClick:(e,a,t)=>{y.push("/dashboard/cliente/".concat(a.id))}}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n(),{className:"img-fluid",alt:"engrane",src:S.Z,width:350,height:210}),(0,s.jsx)("p",{children:"Loading..."})]})}):(0,s.jsx)(s.Fragment,{})]})]})}}},function(e){e.O(0,[358,413,986,943,396,954,545,933,971,596,744],function(){return e(e.s=4087)}),_N_E=e.O()}]);